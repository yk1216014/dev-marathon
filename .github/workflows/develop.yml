name: ssh command

on:
  push:
    branches:
      - develop

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Execute remote deploy script
        uses: appleboy/ssh-action@v1.0.3
        with:
          # Secretsの打ち間違いを疑わなくて済むよう、接続先を直接指定します
          host: "dev.marathon.rplearn.net"
          username: "kento_yokoyama"
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          port: 22
          # --- ここが最重要：詳細なログを出す設定 ---
          debug: true
          timeout: 30s
          # ---------------------------------------
          script: |
            echo "--- Login Success! ---"
            whoami
            sed -i 's/\r//' /app/kento_yokoyama/deploy.sh
            chmod +x /app/kento_yokoyama/deploy.sh
            bash /app/kento_yokoyama/deploy.sh kento_yokoyama